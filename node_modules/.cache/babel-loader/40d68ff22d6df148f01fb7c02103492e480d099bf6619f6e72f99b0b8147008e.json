{"ast":null,"code":"import{createContext,useContext,useEffect,useMemo,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export function AuthProvider(_ref){let{children}=_ref;const[token,setToken]=useState(()=>localStorage.getItem('hs_token')||'');const[user,setUser]=useState(()=>{const raw=localStorage.getItem('hs_user');return raw?JSON.parse(raw):null;});useEffect(()=>{if(token)localStorage.setItem('hs_token',token);else localStorage.removeItem('hs_token');},[token]);useEffect(()=>{if(user)localStorage.setItem('hs_user',JSON.stringify(user));else localStorage.removeItem('hs_user');},[user]);// Listen for token expiration events from API interceptor\nuseEffect(()=>{const handleTokenExpired=()=>{setToken('');setUser(null);};window.addEventListener('auth:token-expired',handleTokenExpired);return()=>window.removeEventListener('auth:token-expired',handleTokenExpired);},[]);const value=useMemo(()=>({token,user,isAuthenticated:Boolean(token),login:_ref2=>{let{token:t,user:u}=_ref2;setToken(t);setUser(u);},logout:()=>{setToken('');setUser(null);}}),[token,user]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){const ctx=useContext(AuthContext);if(!ctx)throw new Error('useAuth must be used within AuthProvider');return ctx;}","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","token","setToken","localStorage","getItem","user","setUser","raw","JSON","parse","setItem","removeItem","stringify","handleTokenExpired","window","addEventListener","removeEventListener","value","isAuthenticated","Boolean","login","_ref2","t","u","logout","Provider","useAuth","ctx","Error"],"sources":["/Users/sareena/HeartSmiles/heart-smiles-tracker/src/context/AuthContext.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from 'react';\n\nconst AuthContext = createContext(undefined);\n\nexport function AuthProvider({ children }) {\n  const [token, setToken] = useState(() => localStorage.getItem('hs_token') || '');\n  const [user, setUser] = useState(() => {\n    const raw = localStorage.getItem('hs_user');\n    return raw ? JSON.parse(raw) : null;\n  });\n\n  useEffect(() => {\n    if (token) localStorage.setItem('hs_token', token); else localStorage.removeItem('hs_token');\n  }, [token]);\n\n  useEffect(() => {\n    if (user) localStorage.setItem('hs_user', JSON.stringify(user)); else localStorage.removeItem('hs_user');\n  }, [user]);\n\n  // Listen for token expiration events from API interceptor\n  useEffect(() => {\n    const handleTokenExpired = () => {\n      setToken('');\n      setUser(null);\n    };\n\n    window.addEventListener('auth:token-expired', handleTokenExpired);\n    return () => window.removeEventListener('auth:token-expired', handleTokenExpired);\n  }, []);\n\n  const value = useMemo(() => ({\n    token,\n    user,\n    isAuthenticated: Boolean(token),\n    login: ({ token: t, user: u }) => {\n      setToken(t);\n      setUser(u);\n    },\n    logout: () => {\n      setToken('');\n      setUser(null);\n    }\n  }), [token, user]);\n\n  return (\n    <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\n  return ctx;\n}\n"],"mappings":"AAAA,OAASA,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,OAAO,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEhF,KAAM,CAAAC,WAAW,cAAGP,aAAa,CAACQ,SAAS,CAAC,CAE5C,MAAO,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGT,QAAQ,CAAC,IAAMU,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,EAAI,EAAE,CAAC,CAChF,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,IAAM,CACrC,KAAM,CAAAc,GAAG,CAAGJ,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAC3C,MAAO,CAAAG,GAAG,CAAGC,IAAI,CAACC,KAAK,CAACF,GAAG,CAAC,CAAG,IAAI,CACrC,CAAC,CAAC,CAEFhB,SAAS,CAAC,IAAM,CACd,GAAIU,KAAK,CAAEE,YAAY,CAACO,OAAO,CAAC,UAAU,CAAET,KAAK,CAAC,CAAC,IAAM,CAAAE,YAAY,CAACQ,UAAU,CAAC,UAAU,CAAC,CAC9F,CAAC,CAAE,CAACV,KAAK,CAAC,CAAC,CAEXV,SAAS,CAAC,IAAM,CACd,GAAIc,IAAI,CAAEF,YAAY,CAACO,OAAO,CAAC,SAAS,CAAEF,IAAI,CAACI,SAAS,CAACP,IAAI,CAAC,CAAC,CAAC,IAAM,CAAAF,YAAY,CAACQ,UAAU,CAAC,SAAS,CAAC,CAC1G,CAAC,CAAE,CAACN,IAAI,CAAC,CAAC,CAEV;AACAd,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,kBAAkB,CAAGA,CAAA,GAAM,CAC/BX,QAAQ,CAAC,EAAE,CAAC,CACZI,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAEDQ,MAAM,CAACC,gBAAgB,CAAC,oBAAoB,CAAEF,kBAAkB,CAAC,CACjE,MAAO,IAAMC,MAAM,CAACE,mBAAmB,CAAC,oBAAoB,CAAEH,kBAAkB,CAAC,CACnF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAI,KAAK,CAAGzB,OAAO,CAAC,KAAO,CAC3BS,KAAK,CACLI,IAAI,CACJa,eAAe,CAAEC,OAAO,CAAClB,KAAK,CAAC,CAC/BmB,KAAK,CAAEC,KAAA,EAA2B,IAA1B,CAAEpB,KAAK,CAAEqB,CAAC,CAAEjB,IAAI,CAAEkB,CAAE,CAAC,CAAAF,KAAA,CAC3BnB,QAAQ,CAACoB,CAAC,CAAC,CACXhB,OAAO,CAACiB,CAAC,CAAC,CACZ,CAAC,CACDC,MAAM,CAAEA,CAAA,GAAM,CACZtB,QAAQ,CAAC,EAAE,CAAC,CACZI,OAAO,CAAC,IAAI,CAAC,CACf,CACF,CAAC,CAAC,CAAE,CAACL,KAAK,CAAEI,IAAI,CAAC,CAAC,CAElB,mBACEV,IAAA,CAACC,WAAW,CAAC6B,QAAQ,EAACR,KAAK,CAAEA,KAAM,CAAAjB,QAAA,CAAEA,QAAQ,CAAuB,CAAC,CAEzE,CAEA,MAAO,SAAS,CAAA0B,OAAOA,CAAA,CAAG,CACxB,KAAM,CAAAC,GAAG,CAAGrC,UAAU,CAACM,WAAW,CAAC,CACnC,GAAI,CAAC+B,GAAG,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,0CAA0C,CAAC,CACrE,MAAO,CAAAD,GAAG,CACZ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}