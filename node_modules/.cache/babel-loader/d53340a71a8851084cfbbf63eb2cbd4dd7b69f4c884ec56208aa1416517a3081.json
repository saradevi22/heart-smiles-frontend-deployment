{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import{fetchParticipantById,addParticipantNote,deleteParticipantNote,uploadImage,addParticipantPhoto,deleteParticipantPhoto,fetchPrograms,addParticipantToProgram,removeParticipantFromProgram}from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ParticipantEdit=()=>{var _participant$headshot,_participant$programD,_participant$programs,_participant$programD2,_participant$programs2;const{id}=useParams();const navigate=useNavigate();const{user}=useAuth();const[participant,setParticipant]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[success,setSuccess]=useState('');// Image upload state\nconst[uploadingImage,setUploadingImage]=useState(false);const[imageType,setImageType]=useState('headshot');// 'headshot' or 'program'\nconst[photoCaption,setPhotoCaption]=useState('');const[photoActivity,setPhotoActivity]=useState('');const[photoDate,setPhotoDate]=useState('');// Note state\nconst[noteContent,setNoteContent]=useState('');const[noteType,setNoteType]=useState('general');const[noteDate,setNoteDate]=useState('');const[addingNote,setAddingNote]=useState(false);// Program state\nconst[allPrograms,setAllPrograms]=useState([]);const[programSearchTerm,setProgramSearchTerm]=useState('');const[addProgramId,setAddProgramId]=useState('');useEffect(()=>{if((user===null||user===void 0?void 0:user.role)!=='heartSmiles'){navigate('/participants');return;}loadParticipant();loadAllPrograms();},[id,user]);const loadAllPrograms=async()=>{try{var _resp$data;const resp=await fetchPrograms();const allPrograms=((_resp$data=resp.data)===null||_resp$data===void 0?void 0:_resp$data.programs)||resp.data||[];// Filter out inactive programs\nconst activePrograms=allPrograms.filter(p=>p.isActive!==false);setAllPrograms(activePrograms);}catch(err){// not fatal\n}};const loadParticipant=async()=>{try{setLoading(true);setError('');const response=await fetchParticipantById(id);setParticipant(response.data.participant);}catch(err){var _err$response,_err$response$data;console.error('Error loading participant:',err);setError((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Failed to load participant');}finally{setLoading(false);}};const handleImageUpload=async e=>{const file=e.target.files[0];if(!file)return;if(!file.type.startsWith('image/')){setError('Please select an image file');return;}try{setUploadingImage(true);setError('');setSuccess('');// Upload image to Cloudinary\nconst formData=new FormData();formData.append('image',file);formData.append('type',imageType);formData.append('folder','heart-smiles/participants');const uploadResponse=await uploadImage(formData);const imageData=uploadResponse.data.image;// Add photo to participant\nif(imageType==='headshot'){// Update headshot\nawait addParticipantPhoto(id,{type:'headshot',imageData});setSuccess('Profile photo uploaded successfully!');}else{// Add to uploaded photos\nawait addParticipantPhoto(id,{type:'program',imageData,caption:photoCaption,activity:photoActivity,uploadedAt:photoDate||undefined});setSuccess('Photo uploaded successfully!');// Reset form fields\nsetPhotoCaption('');setPhotoActivity('');setPhotoDate('');}// Reload participant data\nawait loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response2,_err$response2$data;console.error('Error uploading image:',err);setError((err===null||err===void 0?void 0:(_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||'Failed to upload image');}finally{setUploadingImage(false);e.target.value='';// Reset file input\n}};const handleAddNote=async e=>{e.preventDefault();if(!noteContent.trim()){setError('Note content is required');return;}try{setAddingNote(true);setError('');setSuccess('');await addParticipantNote(id,{content:noteContent,type:noteType,createdAt:noteDate||undefined});setSuccess('Note added successfully!');setNoteContent('');setNoteType('general');setNoteDate('');// Reload participant data\nawait loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response3,_err$response3$data;console.error('Error adding note:',err);setError((err===null||err===void 0?void 0:(_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||'Failed to add note');}finally{setAddingNote(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"h2\",{children:\"Loading Participant...\"})});}if(error&&!participant){return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{background:'#f8d7da',color:'#721c24',padding:'12px 20px',borderRadius:'6px',marginBottom:'20px',border:'1px solid #f5c6cb'},children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/participants'),style:{background:'#6c757d',color:'white',border:'none',padding:'10px 20px',borderRadius:'5px',cursor:'pointer'},children:\"\\u2190 Back to Participants\"})]});}if(!participant)return null;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"h1\",{style:{margin:'0 0 5px 0'},children:[\"Edit Participant: \",participant.name]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/participants/\".concat(id)),style:{background:'transparent',color:'#667eea',border:'none',padding:'5px 0',cursor:'pointer',fontSize:'14px',textDecoration:'underline'},children:\"\\u2190 Back to Participant Details\"})]}),success&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#d4edda',color:'#155724',padding:'12px 20px',borderRadius:'6px',marginBottom:'20px',border:'1px solid #c3e6cb'},children:[\"\\u2705 \",success]}),error&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f8d7da',color:'#721c24',padding:'12px 20px',borderRadius:'6px',marginBottom:'20px',border:'1px solid #f5c6cb'},children:[\"\\u274C \",error]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(400px, 1fr))',gap:'20px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',border:'1px solid #e1e5e9',borderRadius:'8px',padding:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'#333',borderBottom:'2px solid #667eea',paddingBottom:'10px'},children:\"Upload Images\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Image Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:imageType,onChange:e=>setImageType(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"headshot\",children:\"Profile Photo (Headshot)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"program\",children:\"Program Photo\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Select Image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,disabled:uploadingImage,style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px'}}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'12px',color:'#666',margin:'5px 0 0 0'},children:\"Maximum file size: 10MB. Supported formats: JPG, PNG, GIF\"})]}),imageType==='program'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Caption (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:photoCaption,onChange:e=>setPhotoCaption(e.target.value),placeholder:\"e.g., 'Participant at summer camp'\",style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Activity (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:photoActivity,onChange:e=>setPhotoActivity(e.target.value),placeholder:\"e.g., 'Mentorship Session'\",style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Photo Date (optional, defaults to today)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:photoDate,onChange:e=>setPhotoDate(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box'}})]})]}),uploadingImage&&/*#__PURE__*/_jsx(\"div\",{style:{background:'#e7f3ff',padding:'10px',borderRadius:'4px',textAlign:'center',color:'#0066cc'},children:\"Uploading image...\"}),participant.headshotPictureUrl&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',paddingTop:'20px',borderTop:'1px solid #e1e5e9'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'13px',color:'#666'},children:\"Current Profile Photo:\"}),/*#__PURE__*/_jsx(\"img\",{src:((_participant$headshot=participant.headshotPictureUrl)===null||_participant$headshot===void 0?void 0:_participant$headshot.url)||participant.headshotPictureUrl,alt:\"Current profile\",style:{maxWidth:'100%',maxHeight:'200px',marginTop:'10px',borderRadius:'6px',border:'1px solid #e1e5e9'}})]}),participant.uploadedPhotos&&participant.uploadedPhotos.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',paddingTop:'20px',borderTop:'1px solid #e1e5e9'},children:[/*#__PURE__*/_jsxs(\"strong\",{style:{fontSize:'13px',color:'#666'},children:[\"Uploaded Photos (\",participant.uploadedPhotos.length,\"):\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'10px',display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(150px, 1fr))',gap:'10px'},children:participant.uploadedPhotos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"img\",{src:photo.url,alt:photo.caption||'Photo',style:{width:'100%',height:'120px',objectFit:'cover',borderRadius:'4px',border:'1px solid #e1e5e9'}}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(window.confirm('Are you sure you want to delete this photo?')){try{await deleteParticipantPhoto(id,photo.id);setSuccess('Photo deleted successfully!');await loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response4,_err$response4$data;setError((err===null||err===void 0?void 0:(_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.error)||'Failed to delete photo');}}},style:{position:'absolute',top:'5px',right:'5px',background:'rgba(220, 53, 69, 0.9)',color:'white',border:'none',borderRadius:'50%',width:'24px',height:'24px',cursor:'pointer',fontSize:'14px',display:'flex',alignItems:'center',justifyContent:'center'},title:\"Delete photo\",children:\"\\xD7\"}),photo.caption&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'11px',color:'#666',marginTop:'4px',overflow:'hidden',textOverflow:'ellipsis'},children:photo.caption})]},photo.id||index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',border:'1px solid #e1e5e9',borderRadius:'8px',padding:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 20px 0',color:'#333',borderBottom:'2px solid #667eea',paddingBottom:'10px'},children:\"Add Note\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddNote,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Note Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:noteType,onChange:e=>setNoteType(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"general\",children:\"General\"}),/*#__PURE__*/_jsx(\"option\",{value:\"session\",children:\"Session\"}),/*#__PURE__*/_jsx(\"option\",{value:\"milestone\",children:\"Milestone\"}),/*#__PURE__*/_jsx(\"option\",{value:\"concern\",children:\"Concern\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Note Date (optional, defaults to today)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:noteDate,onChange:e=>setNoteDate(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box',marginBottom:'15px'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'15px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontWeight:'500'},children:\"Note Content *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:noteContent,onChange:e=>setNoteContent(e.target.value),rows:\"6\",required:true,placeholder:\"Enter your note here...\",style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',fontFamily:'inherit',resize:'vertical'}})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:addingNote||!noteContent.trim(),style:{width:'100%',background:addingNote?'#6c757d':'#28a745',color:'white',border:'none',padding:'10px 20px',borderRadius:'5px',cursor:addingNote||!noteContent.trim()?'not-allowed':'pointer',fontSize:'14px',fontWeight:'500',opacity:addingNote||!noteContent.trim()?0.6:1},children:addingNote?'Adding Note...':'Add Note'})]}),participant.notes&&participant.notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px',paddingTop:'20px',borderTop:'1px solid #e1e5e9'},children:[/*#__PURE__*/_jsxs(\"strong\",{style:{fontSize:'13px',color:'#666'},children:[\"Recent Notes (\",participant.notes.length,\"):\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'10px',maxHeight:'300px',overflowY:'auto'},children:participant.notes.slice().reverse().map((note,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f8f9fa',padding:'10px',borderRadius:'4px',marginBottom:'8px',fontSize:'12px',position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(window.confirm('Are you sure you want to delete this note?')){try{await deleteParticipantNote(id,note.id);setSuccess('Note deleted successfully!');await loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response5,_err$response5$data;setError((err===null||err===void 0?void 0:(_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.error)||'Failed to delete note');}}},style:{position:'absolute',top:'5px',right:'5px',background:'#dc3545',color:'white',border:'none',borderRadius:'4px',padding:'2px 8px',cursor:'pointer',fontSize:'11px'},children:\"Delete\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:'500',color:'#333',marginBottom:'3px'},children:[note.author||'Staff',\" \\u2022 \",note.type||'general']}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',marginBottom:'3px'},children:note.content}),note.createdAt&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'11px',color:'#999'},children:(()=>{try{// Handle Firestore Timestamp format\nif(note.createdAt&&typeof note.createdAt==='object'){if(note.createdAt.seconds){return new Date(note.createdAt.seconds*1000).toLocaleDateString();}else if(note.createdAt.toDate){return note.createdAt.toDate().toLocaleDateString();}else if(note.createdAt._seconds){return new Date(note.createdAt._seconds*1000).toLocaleDateString();}}// Handle Date object or ISO string\nconst date=new Date(note.createdAt);if(!isNaN(date.getTime())){return date.toLocaleDateString();}return'Invalid Date';}catch(e){console.error('Error formatting note date:',e,note.createdAt);return'Invalid Date';}})()})]},note.id||index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',border:'1px solid #e1e5e9',borderRadius:'8px',padding:'20px',gridColumn:'1 / -1'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'0 0 20px 0',color:'#333',borderBottom:'2px solid #667eea',paddingBottom:'10px'},children:[\"Programs (\",((_participant$programD=participant.programDetails)===null||_participant$programD===void 0?void 0:_participant$programD.length)||((_participant$programs=participant.programs)===null||_participant$programs===void 0?void 0:_participant$programs.length)||0,\")\"]}),(((_participant$programD2=participant.programDetails)===null||_participant$programD2===void 0?void 0:_participant$programD2.length)>0||((_participant$programs2=participant.programs)===null||_participant$programs2===void 0?void 0:_participant$programs2.length)>0)&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'20px'},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexWrap:'wrap',gap:'10px'},children:(participant.programDetails||[]).map((program,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f8f9fa',padding:'10px 15px',borderRadius:'6px',border:'1px solid #e1e5e9',display:'flex',alignItems:'center',gap:'12px',position:'relative',flex:'1 1 250px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',color:'#333'},children:program.name}),program.description&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#666',marginTop:'3px'},children:program.description.length>100?\"\".concat(program.description.substring(0,100),\"...\"):program.description})]}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(window.confirm(\"Are you sure you want to remove this participant from \\\"\".concat(program.name,\"\\\"?\"))){try{setError('');await removeParticipantFromProgram(id,program.id);setSuccess('Participant removed from program successfully!');await loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response6,_err$response6$data;setError((err===null||err===void 0?void 0:(_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.error)||'Failed to remove participant from program');}}},style:{background:'#dc3545',color:'white',border:'none',padding:'4px 10px',borderRadius:'4px',cursor:'pointer',fontSize:'12px',whiteSpace:'nowrap'},children:\"Remove\"})]},program.id||index))})}),/*#__PURE__*/_jsxs(\"div\",{style:{paddingTop:'20px',borderTop:'1px solid #e1e5e9'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 15px 0',color:'#333',fontSize:'16px'},children:\"Add Program\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:async e=>{e.preventDefault();if(!addProgramId)return;try{setError('');await addParticipantToProgram(id,addProgramId);setSuccess('Participant added to program successfully!');setAddProgramId('');setProgramSearchTerm('');await loadParticipant();setTimeout(()=>setSuccess(''),3000);}catch(err){var _err$response7,_err$response7$data;setError((err===null||err===void 0?void 0:(_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:_err$response7$data.error)||'Failed to add participant to program');}},style:{display:'flex',flexDirection:'column',gap:'10px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'5px',fontWeight:'500',fontSize:'14px'},children:\"Search Programs\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:programSearchTerm,onChange:e=>{setProgramSearchTerm(e.target.value);// Reset selected program if it's no longer in filtered list\nconst participantProgramIds=(participant.programDetails||[]).map(p=>p.id).concat(participant.programs||[]);const filteredPrograms=allPrograms.filter(program=>{var _program$description;const isNotInParticipant=!participantProgramIds.includes(program.id);const searchTerm=e.target.value.toLowerCase();const matchesSearch=!searchTerm||program.name.toLowerCase().includes(searchTerm)||((_program$description=program.description)===null||_program$description===void 0?void 0:_program$description.toLowerCase().includes(searchTerm));return isNotInParticipant&&matchesSearch;});if(addProgramId&&!filteredPrograms.find(p=>p.id===addProgramId)){setAddProgramId('');}},placeholder:\"Search by program name or description...\",style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box'}})]}),(()=>{const participantProgramIds=(participant.programDetails||[]).map(p=>p.id).concat(participant.programs||[]);const searchLower=programSearchTerm.toLowerCase().trim();const filteredPrograms=allPrograms.filter(program=>{// Only show active programs\nif(program.isActive===false)return false;// Exclude programs already assigned to participant\nconst isNotInParticipant=!participantProgramIds.includes(program.id);if(!isNotInParticipant)return false;// Match search term if provided\nif(searchLower){var _program$name,_program$description2;const nameMatch=(_program$name=program.name)===null||_program$name===void 0?void 0:_program$name.toLowerCase().includes(searchLower);const descMatch=(_program$description2=program.description)===null||_program$description2===void 0?void 0:_program$description2.toLowerCase().includes(searchLower);return nameMatch||descMatch;}return true;});if(filteredPrograms.length>0){return/*#__PURE__*/_jsxs(\"select\",{value:addProgramId,onChange:e=>setAddProgramId(e.target.value),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'14px',boxSizing:'border-box'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a program...\"}),filteredPrograms.map(program=>/*#__PURE__*/_jsxs(\"option\",{value:program.id,children:[program.name,\" \",program.description&&\"- \".concat(program.description.substring(0,50)).concat(program.description.length>50?'...':'')]},program.id))]},\"program-select-\".concat(programSearchTerm,\"-\").concat(filteredPrograms.length));}else{return/*#__PURE__*/_jsx(\"div\",{style:{padding:'10px',background:'#f8f9fa',borderRadius:'4px',color:'#666',fontSize:'14px'},children:programSearchTerm?'No programs found matching your search.':'All programs are already assigned to this participant.'});}})(),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!addProgramId,style:{background:addProgramId?'#28a745':'#6c757d',color:'white',border:'none',padding:'10px 20px',borderRadius:'5px',cursor:addProgramId?'pointer':'not-allowed',fontSize:'14px',fontWeight:'500',opacity:addProgramId?1:0.6},children:\"Add Program\"})]})]})]})]})]});};export default ParticipantEdit;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useAuth","fetchParticipantById","addParticipantNote","deleteParticipantNote","uploadImage","addParticipantPhoto","deleteParticipantPhoto","fetchPrograms","addParticipantToProgram","removeParticipantFromProgram","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ParticipantEdit","_participant$headshot","_participant$programD","_participant$programs","_participant$programD2","_participant$programs2","id","navigate","user","participant","setParticipant","loading","setLoading","error","setError","success","setSuccess","uploadingImage","setUploadingImage","imageType","setImageType","photoCaption","setPhotoCaption","photoActivity","setPhotoActivity","photoDate","setPhotoDate","noteContent","setNoteContent","noteType","setNoteType","noteDate","setNoteDate","addingNote","setAddingNote","allPrograms","setAllPrograms","programSearchTerm","setProgramSearchTerm","addProgramId","setAddProgramId","role","loadParticipant","loadAllPrograms","_resp$data","resp","data","programs","activePrograms","filter","p","isActive","err","response","_err$response","_err$response$data","console","handleImageUpload","e","file","target","files","type","startsWith","formData","FormData","append","uploadResponse","imageData","image","caption","activity","uploadedAt","undefined","setTimeout","_err$response2","_err$response2$data","value","handleAddNote","preventDefault","trim","content","createdAt","_err$response3","_err$response3$data","style","padding","textAlign","children","background","color","borderRadius","marginBottom","border","onClick","cursor","margin","name","concat","fontSize","textDecoration","display","gridTemplateColumns","gap","borderBottom","paddingBottom","fontWeight","onChange","width","accept","disabled","placeholder","boxSizing","headshotPictureUrl","marginTop","paddingTop","borderTop","src","url","alt","maxWidth","maxHeight","uploadedPhotos","length","map","photo","index","position","height","objectFit","window","confirm","_err$response4","_err$response4$data","top","right","alignItems","justifyContent","title","overflow","textOverflow","onSubmit","rows","required","fontFamily","resize","opacity","notes","overflowY","slice","reverse","note","_err$response5","_err$response5$data","author","seconds","Date","toLocaleDateString","toDate","_seconds","date","isNaN","getTime","gridColumn","programDetails","flexWrap","program","flex","description","substring","_err$response6","_err$response6$data","whiteSpace","_err$response7","_err$response7$data","flexDirection","participantProgramIds","filteredPrograms","_program$description","isNotInParticipant","includes","searchTerm","toLowerCase","matchesSearch","find","searchLower","_program$name","_program$description2","nameMatch","descMatch"],"sources":["/Users/sareena/HeartSmiles/heart-smiles-tracker/src/pages/ParticipantEdit.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { fetchParticipantById, addParticipantNote, deleteParticipantNote, uploadImage, addParticipantPhoto, deleteParticipantPhoto, fetchPrograms, addParticipantToProgram, removeParticipantFromProgram } from '../services/api';\n\nconst ParticipantEdit = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [participant, setParticipant] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  \n  // Image upload state\n  const [uploadingImage, setUploadingImage] = useState(false);\n  const [imageType, setImageType] = useState('headshot'); // 'headshot' or 'program'\n  const [photoCaption, setPhotoCaption] = useState('');\n  const [photoActivity, setPhotoActivity] = useState('');\n  const [photoDate, setPhotoDate] = useState('');\n  \n  // Note state\n  const [noteContent, setNoteContent] = useState('');\n  const [noteType, setNoteType] = useState('general');\n  const [noteDate, setNoteDate] = useState('');\n  const [addingNote, setAddingNote] = useState(false);\n  \n  // Program state\n  const [allPrograms, setAllPrograms] = useState([]);\n  const [programSearchTerm, setProgramSearchTerm] = useState('');\n  const [addProgramId, setAddProgramId] = useState('');\n\n  useEffect(() => {\n    if (user?.role !== 'heartSmiles') {\n      navigate('/participants');\n      return;\n    }\n    loadParticipant();\n    loadAllPrograms();\n  }, [id, user]);\n  \n  const loadAllPrograms = async () => {\n    try {\n      const resp = await fetchPrograms();\n      const allPrograms = resp.data?.programs || resp.data || [];\n      // Filter out inactive programs\n      const activePrograms = allPrograms.filter(p => p.isActive !== false);\n      setAllPrograms(activePrograms);\n    } catch (err) {\n      // not fatal\n    }\n  };\n\n  const loadParticipant = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const response = await fetchParticipantById(id);\n      setParticipant(response.data.participant);\n    } catch (err) {\n      console.error('Error loading participant:', err);\n      setError(err?.response?.data?.error || 'Failed to load participant');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleImageUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    if (!file.type.startsWith('image/')) {\n      setError('Please select an image file');\n      return;\n    }\n\n    try {\n      setUploadingImage(true);\n      setError('');\n      setSuccess('');\n\n      // Upload image to Cloudinary\n      const formData = new FormData();\n      formData.append('image', file);\n      formData.append('type', imageType);\n      formData.append('folder', 'heart-smiles/participants');\n\n      const uploadResponse = await uploadImage(formData);\n      const imageData = uploadResponse.data.image;\n\n      // Add photo to participant\n      if (imageType === 'headshot') {\n        // Update headshot\n        await addParticipantPhoto(id, {\n          type: 'headshot',\n          imageData\n        });\n        setSuccess('Profile photo uploaded successfully!');\n      } else {\n        // Add to uploaded photos\n        await addParticipantPhoto(id, {\n          type: 'program',\n          imageData,\n          caption: photoCaption,\n          activity: photoActivity,\n          uploadedAt: photoDate || undefined\n        });\n        setSuccess('Photo uploaded successfully!');\n        // Reset form fields\n        setPhotoCaption('');\n        setPhotoActivity('');\n        setPhotoDate('');\n      }\n\n      // Reload participant data\n      await loadParticipant();\n      setTimeout(() => setSuccess(''), 3000);\n    } catch (err) {\n      console.error('Error uploading image:', err);\n      setError(err?.response?.data?.error || 'Failed to upload image');\n    } finally {\n      setUploadingImage(false);\n      e.target.value = ''; // Reset file input\n    }\n  };\n\n  const handleAddNote = async (e) => {\n    e.preventDefault();\n    if (!noteContent.trim()) {\n      setError('Note content is required');\n      return;\n    }\n\n    try {\n      setAddingNote(true);\n      setError('');\n      setSuccess('');\n\n      await addParticipantNote(id, {\n        content: noteContent,\n        type: noteType,\n        createdAt: noteDate || undefined\n      });\n\n      setSuccess('Note added successfully!');\n      setNoteContent('');\n      setNoteType('general');\n      setNoteDate('');\n      \n      // Reload participant data\n      await loadParticipant();\n      setTimeout(() => setSuccess(''), 3000);\n    } catch (err) {\n      console.error('Error adding note:', err);\n      setError(err?.response?.data?.error || 'Failed to add note');\n    } finally {\n      setAddingNote(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div style={{ padding: '20px', textAlign: 'center' }}>\n        <h2>Loading Participant...</h2>\n      </div>\n    );\n  }\n\n  if (error && !participant) {\n    return (\n      <div style={{ padding: '20px' }}>\n        <div style={{\n          background: '#f8d7da',\n          color: '#721c24',\n          padding: '12px 20px',\n          borderRadius: '6px',\n          marginBottom: '20px',\n          border: '1px solid #f5c6cb'\n        }}>\n          {error}\n        </div>\n        <button\n          onClick={() => navigate('/participants')}\n          style={{\n            background: '#6c757d',\n            color: 'white',\n            border: 'none',\n            padding: '10px 20px',\n            borderRadius: '5px',\n            cursor: 'pointer'\n          }}\n        >\n          ← Back to Participants\n        </button>\n      </div>\n    );\n  }\n\n  if (!participant) return null;\n\n  return (\n    <div style={{ padding: '20px' }}>\n      <div style={{ marginBottom: '20px' }}>\n        <h1 style={{ margin: '0 0 5px 0' }}>Edit Participant: {participant.name}</h1>\n        <button\n          onClick={() => navigate(`/participants/${id}`)}\n          style={{\n            background: 'transparent',\n            color: '#667eea',\n            border: 'none',\n            padding: '5px 0',\n            cursor: 'pointer',\n            fontSize: '14px',\n            textDecoration: 'underline'\n          }}\n        >\n          ← Back to Participant Details\n        </button>\n      </div>\n\n      {/* Success/Error Messages */}\n      {success && (\n        <div style={{\n          background: '#d4edda',\n          color: '#155724',\n          padding: '12px 20px',\n          borderRadius: '6px',\n          marginBottom: '20px',\n          border: '1px solid #c3e6cb'\n        }}>\n          ✅ {success}\n        </div>\n      )}\n      {error && (\n        <div style={{\n          background: '#f8d7da',\n          color: '#721c24',\n          padding: '12px 20px',\n          borderRadius: '6px',\n          marginBottom: '20px',\n          border: '1px solid #f5c6cb'\n        }}>\n          ❌ {error}\n        </div>\n      )}\n\n      <div style={{\n        display: 'grid',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',\n        gap: '20px'\n      }}>\n        {/* Upload Images Section */}\n        <div style={{\n          background: 'white',\n          border: '1px solid #e1e5e9',\n          borderRadius: '8px',\n          padding: '20px'\n        }}>\n          <h3 style={{ margin: '0 0 20px 0', color: '#333', borderBottom: '2px solid #667eea', paddingBottom: '10px' }}>\n            Upload Images\n          </h3>\n\n          <div style={{ marginBottom: '20px' }}>\n            <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n              Image Type\n            </label>\n            <select\n              value={imageType}\n              onChange={(e) => setImageType(e.target.value)}\n              style={{\n                width: '100%',\n                padding: '8px 12px',\n                border: '1px solid #ddd',\n                borderRadius: '4px',\n                fontSize: '14px'\n              }}\n            >\n              <option value=\"headshot\">Profile Photo (Headshot)</option>\n              <option value=\"program\">Program Photo</option>\n            </select>\n          </div>\n\n          <div style={{ marginBottom: '20px' }}>\n            <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n              Select Image\n            </label>\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleImageUpload}\n              disabled={uploadingImage}\n              style={{\n                width: '100%',\n                padding: '8px 12px',\n                border: '1px solid #ddd',\n                borderRadius: '4px',\n                fontSize: '14px'\n              }}\n            />\n            <p style={{ fontSize: '12px', color: '#666', margin: '5px 0 0 0' }}>\n              Maximum file size: 10MB. Supported formats: JPG, PNG, GIF\n            </p>\n          </div>\n\n          {imageType === 'program' && (\n            <>\n              <div style={{ marginBottom: '15px' }}>\n                <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                  Caption (optional)\n                </label>\n                <input\n                  type=\"text\"\n                  value={photoCaption}\n                  onChange={(e) => setPhotoCaption(e.target.value)}\n                  placeholder=\"e.g., 'Participant at summer camp'\"\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '1px solid #ddd',\n                    borderRadius: '4px',\n                    fontSize: '14px',\n                    boxSizing: 'border-box'\n                  }}\n                />\n              </div>\n              <div style={{ marginBottom: '15px' }}>\n                <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                  Activity (optional)\n                </label>\n                <input\n                  type=\"text\"\n                  value={photoActivity}\n                  onChange={(e) => setPhotoActivity(e.target.value)}\n                  placeholder=\"e.g., 'Mentorship Session'\"\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '1px solid #ddd',\n                    borderRadius: '4px',\n                    fontSize: '14px',\n                    boxSizing: 'border-box'\n                  }}\n                />\n              </div>\n              <div style={{ marginBottom: '20px' }}>\n                <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                  Photo Date (optional, defaults to today)\n                </label>\n                <input\n                  type=\"date\"\n                  value={photoDate}\n                  onChange={(e) => setPhotoDate(e.target.value)}\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '1px solid #ddd',\n                    borderRadius: '4px',\n                    fontSize: '14px',\n                    boxSizing: 'border-box'\n                  }}\n                />\n              </div>\n            </>\n          )}\n\n          {uploadingImage && (\n            <div style={{\n              background: '#e7f3ff',\n              padding: '10px',\n              borderRadius: '4px',\n              textAlign: 'center',\n              color: '#0066cc'\n            }}>\n              Uploading image...\n            </div>\n          )}\n\n          {/* Current Profile Photo */}\n          {participant.headshotPictureUrl && (\n            <div style={{ marginTop: '20px', paddingTop: '20px', borderTop: '1px solid #e1e5e9' }}>\n              <strong style={{ fontSize: '13px', color: '#666' }}>Current Profile Photo:</strong>\n              <img\n                src={participant.headshotPictureUrl?.url || participant.headshotPictureUrl}\n                alt=\"Current profile\"\n                style={{\n                  maxWidth: '100%',\n                  maxHeight: '200px',\n                  marginTop: '10px',\n                  borderRadius: '6px',\n                  border: '1px solid #e1e5e9'\n                }}\n              />\n            </div>\n          )}\n\n          {/* Uploaded Photos with Delete */}\n          {participant.uploadedPhotos && participant.uploadedPhotos.length > 0 && (\n            <div style={{ marginTop: '20px', paddingTop: '20px', borderTop: '1px solid #e1e5e9' }}>\n              <strong style={{ fontSize: '13px', color: '#666' }}>Uploaded Photos ({participant.uploadedPhotos.length}):</strong>\n              <div style={{ marginTop: '10px', display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(150px, 1fr))', gap: '10px' }}>\n                {participant.uploadedPhotos.map((photo, index) => (\n                  <div key={photo.id || index} style={{ position: 'relative' }}>\n                    <img\n                      src={photo.url}\n                      alt={photo.caption || 'Photo'}\n                      style={{\n                        width: '100%',\n                        height: '120px',\n                        objectFit: 'cover',\n                        borderRadius: '4px',\n                        border: '1px solid #e1e5e9'\n                      }}\n                    />\n                    <button\n                      onClick={async () => {\n                        if (window.confirm('Are you sure you want to delete this photo?')) {\n                          try {\n                            await deleteParticipantPhoto(id, photo.id);\n                            setSuccess('Photo deleted successfully!');\n                            await loadParticipant();\n                            setTimeout(() => setSuccess(''), 3000);\n                          } catch (err) {\n                            setError(err?.response?.data?.error || 'Failed to delete photo');\n                          }\n                        }\n                      }}\n                      style={{\n                        position: 'absolute',\n                        top: '5px',\n                        right: '5px',\n                        background: 'rgba(220, 53, 69, 0.9)',\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '50%',\n                        width: '24px',\n                        height: '24px',\n                        cursor: 'pointer',\n                        fontSize: '14px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center'\n                      }}\n                      title=\"Delete photo\"\n                    >\n                      ×\n                    </button>\n                    {photo.caption && (\n                      <div style={{ fontSize: '11px', color: '#666', marginTop: '4px', overflow: 'hidden', textOverflow: 'ellipsis' }}>\n                        {photo.caption}\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Add Notes Section */}\n        <div style={{\n          background: 'white',\n          border: '1px solid #e1e5e9',\n          borderRadius: '8px',\n          padding: '20px'\n        }}>\n          <h3 style={{ margin: '0 0 20px 0', color: '#333', borderBottom: '2px solid #667eea', paddingBottom: '10px' }}>\n            Add Note\n          </h3>\n\n          <form onSubmit={handleAddNote}>\n            <div style={{ marginBottom: '15px' }}>\n              <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                Note Type\n              </label>\n              <select\n                value={noteType}\n                onChange={(e) => setNoteType(e.target.value)}\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '14px'\n                }}\n              >\n                <option value=\"general\">General</option>\n                <option value=\"session\">Session</option>\n                <option value=\"milestone\">Milestone</option>\n                <option value=\"concern\">Concern</option>\n              </select>\n            </div>\n\n            <div style={{ marginBottom: '15px' }}>\n              <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                Note Date (optional, defaults to today)\n              </label>\n              <input\n                type=\"date\"\n                value={noteDate}\n                onChange={(e) => setNoteDate(e.target.value)}\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '14px',\n                  boxSizing: 'border-box',\n                  marginBottom: '15px'\n                }}\n              />\n            </div>\n\n            <div style={{ marginBottom: '15px' }}>\n              <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>\n                Note Content *\n              </label>\n              <textarea\n                value={noteContent}\n                onChange={(e) => setNoteContent(e.target.value)}\n                rows=\"6\"\n                required\n                placeholder=\"Enter your note here...\"\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '14px',\n                  fontFamily: 'inherit',\n                  resize: 'vertical'\n                }}\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={addingNote || !noteContent.trim()}\n              style={{\n                width: '100%',\n                background: addingNote ? '#6c757d' : '#28a745',\n                color: 'white',\n                border: 'none',\n                padding: '10px 20px',\n                borderRadius: '5px',\n                cursor: addingNote || !noteContent.trim() ? 'not-allowed' : 'pointer',\n                fontSize: '14px',\n                fontWeight: '500',\n                opacity: addingNote || !noteContent.trim() ? 0.6 : 1\n              }}\n            >\n              {addingNote ? 'Adding Note...' : 'Add Note'}\n            </button>\n          </form>\n\n          {/* Recent Notes Preview with Delete */}\n          {participant.notes && participant.notes.length > 0 && (\n            <div style={{ marginTop: '30px', paddingTop: '20px', borderTop: '1px solid #e1e5e9' }}>\n              <strong style={{ fontSize: '13px', color: '#666' }}>Recent Notes ({participant.notes.length}):</strong>\n              <div style={{ marginTop: '10px', maxHeight: '300px', overflowY: 'auto' }}>\n                {participant.notes.slice().reverse().map((note, index) => (\n                  <div\n                    key={note.id || index}\n                    style={{\n                      background: '#f8f9fa',\n                      padding: '10px',\n                      borderRadius: '4px',\n                      marginBottom: '8px',\n                      fontSize: '12px',\n                      position: 'relative'\n                    }}\n                  >\n                    <button\n                      onClick={async () => {\n                        if (window.confirm('Are you sure you want to delete this note?')) {\n                          try {\n                            await deleteParticipantNote(id, note.id);\n                            setSuccess('Note deleted successfully!');\n                            await loadParticipant();\n                            setTimeout(() => setSuccess(''), 3000);\n                          } catch (err) {\n                            setError(err?.response?.data?.error || 'Failed to delete note');\n                          }\n                        }\n                      }}\n                      style={{\n                        position: 'absolute',\n                        top: '5px',\n                        right: '5px',\n                        background: '#dc3545',\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '4px',\n                        padding: '2px 8px',\n                        cursor: 'pointer',\n                        fontSize: '11px'\n                      }}\n                    >\n                      Delete\n                    </button>\n                    <div style={{ fontWeight: '500', color: '#333', marginBottom: '3px' }}>\n                      {note.author || 'Staff'} • {note.type || 'general'}\n                    </div>\n                    <div style={{ color: '#666', marginBottom: '3px' }}>{note.content}</div>\n                    {note.createdAt && (\n                      <div style={{ fontSize: '11px', color: '#999' }}>\n                        {(() => {\n                          try {\n                            // Handle Firestore Timestamp format\n                            if (note.createdAt && typeof note.createdAt === 'object') {\n                              if (note.createdAt.seconds) {\n                                return new Date(note.createdAt.seconds * 1000).toLocaleDateString();\n                              } else if (note.createdAt.toDate) {\n                                return note.createdAt.toDate().toLocaleDateString();\n                              } else if (note.createdAt._seconds) {\n                                return new Date(note.createdAt._seconds * 1000).toLocaleDateString();\n                              }\n                            }\n                            // Handle Date object or ISO string\n                            const date = new Date(note.createdAt);\n                            if (!isNaN(date.getTime())) {\n                              return date.toLocaleDateString();\n                            }\n                            return 'Invalid Date';\n                          } catch (e) {\n                            console.error('Error formatting note date:', e, note.createdAt);\n                            return 'Invalid Date';\n                          }\n                        })()}\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Programs Section */}\n        <div style={{\n          background: 'white',\n          border: '1px solid #e1e5e9',\n          borderRadius: '8px',\n          padding: '20px',\n          gridColumn: '1 / -1'\n        }}>\n          <h3 style={{ margin: '0 0 20px 0', color: '#333', borderBottom: '2px solid #667eea', paddingBottom: '10px' }}>\n            Programs ({participant.programDetails?.length || participant.programs?.length || 0})\n          </h3>\n          \n          {(participant.programDetails?.length > 0 || participant.programs?.length > 0) && (\n            <div style={{ marginBottom: '20px' }}>\n              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '10px' }}>\n                {(participant.programDetails || []).map((program, index) => (\n                  <div\n                    key={program.id || index}\n                    style={{\n                      background: '#f8f9fa',\n                      padding: '10px 15px',\n                      borderRadius: '6px',\n                      border: '1px solid #e1e5e9',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '12px',\n                      position: 'relative',\n                      flex: '1 1 250px'\n                    }}\n                  >\n                    <div style={{ flex: 1 }}>\n                      <div style={{ fontWeight: '500', color: '#333' }}>{program.name}</div>\n                      {program.description && (\n                        <div style={{ fontSize: '12px', color: '#666', marginTop: '3px' }}>\n                          {program.description.length > 100 \n                            ? `${program.description.substring(0, 100)}...`\n                            : program.description}\n                        </div>\n                      )}\n                    </div>\n                    <button\n                      onClick={async () => {\n                        if (window.confirm(`Are you sure you want to remove this participant from \"${program.name}\"?`)) {\n                          try {\n                            setError('');\n                            await removeParticipantFromProgram(id, program.id);\n                            setSuccess('Participant removed from program successfully!');\n                            await loadParticipant();\n                            setTimeout(() => setSuccess(''), 3000);\n                          } catch (err) {\n                            setError(err?.response?.data?.error || 'Failed to remove participant from program');\n                          }\n                        }\n                      }}\n                      style={{\n                        background: '#dc3545',\n                        color: 'white',\n                        border: 'none',\n                        padding: '4px 10px',\n                        borderRadius: '4px',\n                        cursor: 'pointer',\n                        fontSize: '12px',\n                        whiteSpace: 'nowrap'\n                      }}\n                    >\n                      Remove\n                    </button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div style={{ paddingTop: '20px', borderTop: '1px solid #e1e5e9' }}>\n            <h4 style={{ margin: '0 0 15px 0', color: '#333', fontSize: '16px' }}>\n              Add Program\n            </h4>\n            <form onSubmit={async (e) => {\n              e.preventDefault();\n              if (!addProgramId) return;\n              try {\n                setError('');\n                await addParticipantToProgram(id, addProgramId);\n                setSuccess('Participant added to program successfully!');\n                setAddProgramId('');\n                setProgramSearchTerm('');\n                await loadParticipant();\n                setTimeout(() => setSuccess(''), 3000);\n              } catch (err) {\n                setError(err?.response?.data?.error || 'Failed to add participant to program');\n              }\n            }} style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\n              <div>\n                <label style={{ display: 'block', marginBottom: '5px', fontWeight: '500', fontSize: '14px' }}>\n                  Search Programs\n                </label>\n                <input\n                  type=\"text\"\n                  value={programSearchTerm}\n                  onChange={(e) => {\n                    setProgramSearchTerm(e.target.value);\n                    // Reset selected program if it's no longer in filtered list\n                    const participantProgramIds = (participant.programDetails || []).map(p => p.id).concat(participant.programs || []);\n                    const filteredPrograms = allPrograms.filter(program => {\n                      const isNotInParticipant = !participantProgramIds.includes(program.id);\n                      const searchTerm = e.target.value.toLowerCase();\n                      const matchesSearch = !searchTerm || \n                        program.name.toLowerCase().includes(searchTerm) ||\n                        program.description?.toLowerCase().includes(searchTerm);\n                      return isNotInParticipant && matchesSearch;\n                    });\n                    if (addProgramId && !filteredPrograms.find(p => p.id === addProgramId)) {\n                      setAddProgramId('');\n                    }\n                  }}\n                  placeholder=\"Search by program name or description...\"\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '1px solid #ddd',\n                    borderRadius: '4px',\n                    fontSize: '14px',\n                    boxSizing: 'border-box'\n                  }}\n                />\n              </div>\n              {(() => {\n                const participantProgramIds = (participant.programDetails || []).map(p => p.id).concat(participant.programs || []);\n                const searchLower = programSearchTerm.toLowerCase().trim();\n                const filteredPrograms = allPrograms.filter(program => {\n                  // Only show active programs\n                  if (program.isActive === false) return false;\n                  // Exclude programs already assigned to participant\n                  const isNotInParticipant = !participantProgramIds.includes(program.id);\n                  if (!isNotInParticipant) return false;\n                  // Match search term if provided\n                  if (searchLower) {\n                    const nameMatch = program.name?.toLowerCase().includes(searchLower);\n                    const descMatch = program.description?.toLowerCase().includes(searchLower);\n                    return nameMatch || descMatch;\n                  }\n                  return true;\n                });\n                \n                if (filteredPrograms.length > 0) {\n                  return (\n                    <select\n                      key={`program-select-${programSearchTerm}-${filteredPrograms.length}`}\n                      value={addProgramId}\n                      onChange={e => setAddProgramId(e.target.value)}\n                      style={{\n                        width: '100%',\n                        padding: '8px 12px',\n                        border: '1px solid #ddd',\n                        borderRadius: '4px',\n                        fontSize: '14px',\n                        boxSizing: 'border-box'\n                      }}\n                    >\n                      <option value=\"\">Select a program...</option>\n                      {filteredPrograms.map(program => (\n                        <option key={program.id} value={program.id}>\n                          {program.name} {program.description && `- ${program.description.substring(0, 50)}${program.description.length > 50 ? '...' : ''}`}\n                        </option>\n                      ))}\n                    </select>\n                  );\n                } else {\n                  return (\n                    <div style={{ padding: '10px', background: '#f8f9fa', borderRadius: '4px', color: '#666', fontSize: '14px' }}>\n                      {programSearchTerm ? 'No programs found matching your search.' : 'All programs are already assigned to this participant.'}\n                    </div>\n                  );\n                }\n              })()}\n              <button\n                type=\"submit\"\n                disabled={!addProgramId}\n                style={{\n                  background: addProgramId ? '#28a745' : '#6c757d',\n                  color: 'white',\n                  border: 'none',\n                  padding: '10px 20px',\n                  borderRadius: '5px',\n                  cursor: addProgramId ? 'pointer' : 'not-allowed',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  opacity: addProgramId ? 1 : 0.6\n                }}\n              >\n                Add Program\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ParticipantEdit;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}